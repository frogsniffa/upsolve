# Background

## Entropoid based cryptography

Let $(G, \cdot)$ be a group with two generators $g_1, g_2$ such that for any element in $G$, it is of the form $g_1^ig_2^j$ where $i, j$ are integers. Let the number of elements generated by $g_1, g_2$ each be $q$ so that the order of $G$ is $q^2$.

Let an operation applied to $x, y$ be $x\cdot T(y)$ where $T$ is an involutive automorphism. That just means $T(T(y)) = y$ and $T(x\cdot y) = T(x) \cdot T(y)$ and $T$ is bijective on all elements in $G$. This operation is called an entropoid. An algebraic structure with an entropoid group structure, $\mathbb{E}_{q^2}$, has a generator $g\in G$ if $g$ and $T(g)$ generate independent elements of order $q$.

Let a power index $X = (x_1, x_2)$ be defined with respect to exponentiation. For any $g\in G$, $g^X = g^{x_1}\cdot T(g^{x_2})$. The power indices have special rules:

1. $X+Y = (x_1+y_1, x_2+y_2)\bmod{q}$
2. $X-Y = (x_1-y_1, x_2-y_2)\bmod{q}$
3. $XY = (x_1y_1 + x_2y_2, x_1y_2 + x_2y_1)\bmod{q}$
4. $X/Y= ((x_1y_1-x_2y_2)/(y_1^2-y_2^2), (x_1y_2-x_2y_1)/(y_1^2-y_2^2))\bmod{q}$, from this $(y_1^2-y_2^2)\not\equiv 0 \bmod{q}$

For any generator $g$ of $\mathbb{E}_{q^2}$, the entropic lift of the discrete logarithm problem is for any $g^a \equiv b\bmod{q}$, find $a$, except now, replace $a$ with the power index $A$ so the unknowns are $(a_1, a_2)$. According to the original paper, $g$ and $T(g)$ are independent which prevents this from becoming DLP.

An instantiation of the entropic lift uses the field of all n x n circulant matrices in $\mathbb{F}_2$, or matrices where each row underneath is the previous one rotated right one. It is isomorphic to the quotient ring $R = \mathbb{F}_2/(x^n-1)$. The specific isomorphism multiplies the nth element of the matrix with $x^n$ (indexing them increasing left to right, top to bottom) and adds the results. The involutive automorphism $T$ is the transposition function which represented in polynomials is $a = a_0+a_1x+...+a_{n-1}x^{n-1}$ and $a^T = a_0+a_{n-1}x+...+a_1x^{n-1}$.

Sequoa is the entropic lift of the Schnorr signature scheme with previous instantiation. Signing a message $M$ would yield

$$
\begin{aligned}
privkey = x \rightarrow (x_1, x_2) \\
pubkey = y = g^x \\
k = Hash(random || privkey || M) \rightarrow (k_1, k_2) \\
r = g^k \\
e = H(r || pubkey || M) \rightarrow (e_1, e_2) \\
s = k - xe \\
return (s, e)
\end{aligned}
$$

To verify, we must show $g^sy^e = r$. Luckily, $g^sy^e = g^{s+ex} = g^{(k - xe) + ex} = g^k = r$.

# Solution

We get $y$ and need to solve for $x$ so that we can sign another random message $M$ with $x$.

The gotchas are that we get back $y$ as a byte string and need to convert it to an int using libntl encoding. Also, Sequoa defines its own generator of $R$.

The flaw is that the modulus of $R$ is reducible so we can solve for DLP in subfields, then combine the results together using CRT. DLP has been defined in Sage over finite fields though seemingly not quotient rings. Therefore, we must lift the elements of the quotient ring to an ambient field (a generalized field) before changing them to be a part of a subfield which dlog is supported. Field extensions are isomorphic to quotient rings and dlog operations are supported there.

Plugging in power index definition and letting $\pi_1$ and $\pi_2$ be the subfields of $R$,

$$
\begin{aligned}
\pi_1(y) = \pi_1(g^{a_1}T(g)^{a_2}) = \pi_1(g)^{a_1+c_1a_2} \\
\pi_2(y) = \pi_2(g^{a_1}T(g)^{a_2}) = \pi_1(g)^{a_1+c_2a_2} \\
\pi_1(T(g)) = \pi_1(g)^{c_1} \\
\pi_2(T(g)) = \pi_2(g)^{c_2} \\
\pi_1(y) = \pi_1(g)^{u_1} \\
\pi_2(y) = \pi_2(g)^{u_2} \\
u_1 \equiv a_1+c_1a_2 \bmod{q} \\
u_2 \equiv a_1+c_2a_2 \bmod{q}
\end{aligned}
$$

# Open questions for myself

How do we find the set of all automorphisms of a group (especially an entropoid group)?

How do you automatically factor $x^n-1$?

Would Sequoa have been broken if $x^n-1$ was irreducible?

Is the finite field of size $2^{179}$ adjoined by PI1_QUOTIENT isomorphic to the quotient ring over finite field of size 2 with modulus PI1_QUOTIENT? Why does dlog work in the former but not the latter? How does dlog work with a polynomial adjoined?

What operations besides "inverse" are involutive automorphisms?

# Sources

1. https://eprint.iacr.org/archive/2023/318/1677848780.pdf
2. https://eprint.iacr.org/2023/318.pdf
3. https://eprint.iacr.org/2021/583.pdf
4. https://hxp.io/blog/95/
5. https://libntl.org/doc/GF2X.cpp.html
6. https://math.stackexchange.com/questions/2702527/trying-to-understand-the-relation-between-quotient-rings-and-field-extensions
